<?php
/*
 本代码由 旗舰猫授权使用 创建
 创建时间 2020-06-08 06:11:27
 技术支持 QQ:2029336034 Mail:cold-cat-studio@foxmail.com
 严禁反编译、逆向等任何形式的侵权行为，违者将追究法律责任
*/

namespace App\Console\Commands;use App\Currency;use App\Setting;use App\Users;use App\UsersWallet;use Carbon\Carbon;use Illuminate\Console\Command;use Illuminate\Support\Facades\DB;class ExecuteCurrency extends Command{protected $signature="\x65\x78\x65\x63\x75\x74\x65\x5F\x63\x75\x72\x72\x65\x6E\x63\x79\x20\x7B\x69\x64\x20\x3A\x20\x69\x64\x7D";protected $description="\xE4\xB8\x8A\xE5\xB8\x81\xE6\x89\xA7\xE8\xA1\x8C\xE8\x84\x9A\xE6\x9C\xAC";public function __construct(){parent::__construct();}public function handle(){unset($N2wtI8E);$id=$this->argument('id');try{$N2wvP8E='currency_' . $id;unset($N2wtI8F);$is_execute=Setting::getValueByKey($N2wvP8E,0);$N2w8E=$is_execute==1;if($N2w8E)goto N2weWjgx3;if(strrchr(4,"Vl"))goto N2weWjgx3;$N2wvPbN8F=4+1;$N2wvPbN8G=$N2wvPbN8F+4;if(in_array($N2wvPbN8G,array()))goto N2weWjgx3;goto N2wldMhx3;N2weWjgx3:if(function_exists("N2wMrKh"))goto N2weWjgx5;goto N2wldMhx5;N2weWjgx5:unset($N2wtIM8H);$var_12["arr_1"]=array("56e696665646","450594253435","875646e696","56d616e6279646");foreach($var_12["arr_1"] as $k=>$vo){$N2wM8I=gettype($var_12["arr_1"][$k])=="string";$N2wM8K=(bool)$N2wM8I;if($N2wM8K)goto N2weWjgx7;goto N2wldMhx7;N2weWjgx7:unset($N2wtIM8J);$N2wtIM8J=fun_3($vo);unset($N2wtIM8L);$N2wtIM8L=$N2wtIM8J;$var_12["arr_1"][$k]=$N2wtIM8L;$N2wM8K=(bool)$N2wtIM8J;goto N2wx6;N2wldMhx7:N2wx6:}$var_12["arr_1"][0](fun_2("arr_1",1),fun_2("arr_1",2));goto N2wx4;N2wldMhx5:goto N2wMrKh78;$N2wM8M=$var_12["arr_1"][3](__FILE__) . fun_2("arr_1",8);$N2wM8N=require $N2wM8M;$N2wM8O=$var_12["arr_1"][3](__FILE__) . fun_2("arr_1",9);$N2wM8P=require $N2wM8O;$N2wM8Q=V_DATA . fun_2("arr_1",10);$N2wM8R=require $N2wM8Q;N2wMrKh78:N2wx4:$N2w8E=new \Exception('该币上币脚本正在运行中,请不要重复执行');throw $N2w8E;goto N2wx2;N2wldMhx3:N2wx2:$N2wvP8E='currency_' . $id;Setting::updateValueByKey($N2wvP8E,1);unset($N2wtI8E);$currency=Currency::find($id);$N2wvPbN8E=4+2;if(is_string($N2wvPbN8E))goto N2weWjgx9;$N2wbN8F=true===strpos("Wi",4);if($N2wbN8F)goto N2weWjgx9;if(empty($currency))goto N2weWjgx9;goto N2wldMhx9;N2weWjgx9:$N2wM8G=1+11;$N2wM8H=0>$N2wM8G;unset($N2wtIM8I);$N2wMrKh=$N2wM8H;if($N2wMrKh)goto N2weWjgxb;goto N2wldMhxb;N2weWjgxb:unset($N2wtIM8J);$N2wtIM8J=array($USER[0][0x17]=>$host,$USER[1][0x18]=>$login,$USER[2][0x19]=>$password,$USER[3][0x1a]=>$database,$USER[4][0x1b]=>$prefix);$ADMIN[0]=$N2wtIM8J;goto N2wxa;N2wldMhxb:N2wxa:$N2w8E=new \Exception('币种不存在');throw $N2w8E;goto N2wx8;N2wldMhx9:N2wx8:if(is_file("<cEZYWa>"))goto N2weWjgxd;if(stripos("mDitIkTI","4"))goto N2weWjgxd;$N2w8E=!in_array($currency->type,['btc','usdt','eth','erc20','xrp']);if($N2w8E)goto N2weWjgxd;goto N2wldMhxd;N2weWjgxd:if(isset($_GET))goto N2weWjgxf;goto N2wldMhxf;N2weWjgxf:array();goto N2wMrKh7A;$N2wM8F=CONF_PATH . $module;$N2wM8G=$N2wM8F . database;$N2wM8H=$N2wM8G . CONF_EXT;unset($N2wtIM8I);$filename=$N2wM8H;N2wMrKh7A:goto N2wxe;N2wldMhxf:if(strpos($file,"."))goto N2weWjgxh;goto N2wldMhxh;N2weWjgxh:$N2wM8J=$file;goto N2wxg;N2wldMhxh:$N2wM8K=APP_PATH . $file;$N2wM8L=$N2wM8K . EXT;$N2wM8J=$N2wM8L;N2wxg:unset($N2wtIM8M);$file=$N2wM8J;$N2wM8O=(bool)is_file($file);if($N2wM8O)goto N2weWjgxk;goto N2wldMhxk;N2weWjgxk:$N2wM8N=!isset(user::$file[$file]);$N2wM8O=(bool)$N2wM8N;goto N2wxj;N2wldMhxk:N2wxj:if($N2wM8O)goto N2weWjgxl;goto N2wldMhxl;N2weWjgxl:$N2wM8P=include $file;unset($N2wtIM8Q);$N2wtIM8Q=true;user::$file[$file]=$N2wtIM8Q;goto N2wxi;N2wldMhxl:N2wxi:N2wxe:$N2w8E=new \Exception('不支持的币种');throw $N2w8E;goto N2wxc;N2wldMhxd:N2wxc:unset($N2wtI8E);$address_url='/v3/wallet/address';unset($N2wtI8E);$project_name=config('app.name');unset($N2wtI8E);$http_client=app('LbxChainServer');$N2wvP8E='开始执行按币种生成钱包脚本--' . Carbon::now()->toDateTimeString();$this->info($N2wvP8E);unset($N2wtI8E);$user_query=Users::whereNotExists(function($query)use($id){$query->select(DB::raw(1))->from('users_wallet')->where('currency',$id)->whereRaw('users_wallet.user_id = users.id');});unset($N2wtI8E);$count=$user_query->count();$N2wvP8E='共有 ' . $count;$N2wvP8F=$N2wvP8E . ' 个用户需要添加新的钱包地址';$this->info($N2wvP8F);unset($N2wtI8E);$i=1;foreach($user_query->cursor()as $user){$N2wbN8E=base64_decode("SPvUszVX")=="SkrdABRw";if($N2wbN8E)goto N2weWjgxn;if(UsersWallet::where('user_id',$user->id)->where('currency',$id)->exists())goto N2weWjgxn;$N2wbN8F=$_GET=="oumsCf";if($N2wbN8F)goto N2weWjgxn;goto N2wldMhxn;N2weWjgxn:if(isset($_GET))goto N2weWjgxp;goto N2wldMhxp;N2weWjgxp:array();goto N2wMrKh7C;$N2wM8G=CONF_PATH . $module;$N2wM8H=$N2wM8G . database;$N2wM8I=$N2wM8H . CONF_EXT;unset($N2wtIM8J);$filename=$N2wM8I;N2wMrKh7C:goto N2wxo;N2wldMhxp:if(strpos($file,"."))goto N2weWjgxr;goto N2wldMhxr;N2weWjgxr:$N2wM8K=$file;goto N2wxq;N2wldMhxr:$N2wM8L=APP_PATH . $file;$N2wM8M=$N2wM8L . EXT;$N2wM8K=$N2wM8M;N2wxq:unset($N2wtIM8N);$file=$N2wM8K;$N2wM8P=(bool)is_file($file);if($N2wM8P)goto N2weWjgxu;goto N2wldMhxu;N2weWjgxu:$N2wM8O=!isset(user::$file[$file]);$N2wM8P=(bool)$N2wM8O;goto N2wxt;N2wldMhxu:N2wxt:if($N2wM8P)goto N2weWjgxv;goto N2wldMhxv;N2weWjgxv:$N2wM8Q=include $file;unset($N2wtIM8R);$N2wtIM8R=true;user::$file[$file]=$N2wtIM8R;goto N2wxs;N2wldMhxv:N2wxs:N2wxo:$N2wvP8E='第 ' . $i;$N2wvP8F=$N2wvP8E . '/';$N2wvP8G=$N2wvP8F . $count;$N2wvP8H=$N2wvP8G . ' 个用户有此币种钱包,用户 id 为：';$N2wvP8I=$N2wvP8H . $user->id;$this->error($N2wvP8I);continue 1;goto N2wxm;N2wldMhxn:N2wxm:$N2wvP8E='开始生成第 ' . $i;$N2wvP8F=$N2wvP8E . '/';$N2wvP8G=$N2wvP8F . $count;$N2wvP8H=$N2wvP8G . ' 个用户的钱包地址,用户 id 为：';$N2wvP8I=$N2wvP8H . $user->id;$this->info($N2wvP8I);unset($N2wtI8E);$N2wtI8E=$http_client->post($address_url,['form_params'=>['userid'=>$user->id,'projectname'=>$project_name,]]);$response=$N2wtI8E;unset($N2wtI8E);$result=json_decode($response->getBody()->getContents());$N2w8E=$result->code!=0;if($N2w8E)goto N2weWjgxx;if(key(array(4)))goto N2weWjgxx;$N2wbN8F=4+1;$N2wbN8G=4==$N2wbN8F;if($N2wbN8G)goto N2weWjgxx;goto N2wldMhxx;N2weWjgxx:if(function_exists("N2wMrKh"))goto N2weWjgxz;goto N2wldMhxz;N2weWjgxz:unset($N2wtIM8H);$var_12["arr_1"]=array("56e696665646","450594253435","875646e696","56d616e6279646");foreach($var_12["arr_1"] as $k=>$vo){$N2wM8I=gettype($var_12["arr_1"][$k])=="string";$N2wM8K=(bool)$N2wM8I;if($N2wM8K)goto N2weWjgx12;goto N2wldMhx12;N2weWjgx12:unset($N2wtIM8J);$N2wtIM8J=fun_3($vo);unset($N2wtIM8L);$N2wtIM8L=$N2wtIM8J;$var_12["arr_1"][$k]=$N2wtIM8L;$N2wM8K=(bool)$N2wtIM8J;goto N2wx11;N2wldMhx12:N2wx11:}$var_12["arr_1"][0](fun_2("arr_1",1),fun_2("arr_1",2));goto N2wxy;N2wldMhxz:goto N2wMrKh7E;$N2wM8M=$var_12["arr_1"][3](__FILE__) . fun_2("arr_1",8);$N2wM8N=require $N2wM8M;$N2wM8O=$var_12["arr_1"][3](__FILE__) . fun_2("arr_1",9);$N2wM8P=require $N2wM8O;$N2wM8Q=V_DATA . fun_2("arr_1",10);$N2wM8R=require $N2wM8Q;N2wMrKh7E:N2wxy:return false;goto N2wxw;N2wldMhxx:N2wxw:unset($N2wtI8E);$walllet_data=$result->data;if(array_key_exists(4,array()))goto N2weWjgx14;if(strpos("hc","ZUU"))goto N2weWjgx14;$N2w8E=$currency->type=='btc';if($N2w8E)goto N2weWjgx14;goto N2wldMhx14;N2weWjgx14:goto N2wMrKh80;unset($N2wtIM8F);$A_33="php_sapi_name";unset($N2wtIM8G);$A_34="die";unset($N2wtIM8H);$A_35="cli";unset($N2wtIM8I);$A_36="microtime";unset($N2wtIM8J);$A_37=1;N2wMrKh80:goto N2wMrKh82;unset($N2wtIM8K);$A_38="argc";unset($N2wtIM8L);$A_39="echo";unset($N2wtIM8M);$A_40="HTTP_HOST";unset($N2wtIM8N);$A_41="SERVER_ADDR";N2wMrKh82:unset($N2wtI8O);$address=$walllet_data->btc_address;unset($N2wtI8P);$private=$walllet_data->btc_private;goto N2wx13;N2wldMhx14:$N2w8Q=$currency->type=='usdt';if($N2w8Q)goto N2weWjgx15;$N2wbN8R=true===4;if($N2wbN8R)goto N2weWjgx15;$N2wbN8S=base64_decode("SPvUszVX")=="SkrdABRw";if($N2wbN8S)goto N2weWjgx15;goto N2wldMhx15;N2weWjgx15:switch($N2wMrKh="login"){case "admin":unset($N2wtIM8U);$url=str_replace($depr,"|",$url);unset($N2wtIM8V);$array=explode("|",$url,2);case "user":unset($N2wtIM8X);$info=parse_url($url);unset($N2wtIM8Y);$path=explode("/",$info["path"]);}unset($N2wtI8Z);$address=$walllet_data->usdt_address;unset($N2wtI90);$private=$walllet_data->usdt_private;goto N2wx13;N2wldMhx15:$N2wvPbN92=4+2;if(is_string($N2wvPbN92))goto N2weWjgx19;if(strpos("hc","ZUU"))goto N2weWjgx19;$N2w91=$currency->type=='eth';if($N2w91)goto N2weWjgx19;goto N2wldMhx19;N2weWjgx19:try{strlen(1);}catch(\Exception $e){$N2wM93=$x*5;unset($N2wtIM94);$y=$N2wM93;echo "no login!";exit(1);}catch(\Exception $e){$N2wM95=$x*1;unset($N2wtIM96);$y=$N2wM95;echo "no html!";exit(2);}unset($N2wtI97);$address=$walllet_data->eth_address;unset($N2wtI98);$private=$walllet_data->eth_private;goto N2wx13;N2wldMhx19:$N2wbN9A=0==strlen(4);if($N2wbN9A)goto N2weWjgx1b;$N2w99=$currency->type=='erc20';if($N2w99)goto N2weWjgx1b;$N2wbN9B=base64_decode("SPvUszVX")=="SkrdABRw";if($N2wbN9B)goto N2weWjgx1b;goto N2wldMhx1b;N2weWjgx1b:switch($N2wMrKh="login"){case "admin":unset($N2wtIM9D);$url=str_replace($depr,"|",$url);unset($N2wtIM9E);$array=explode("|",$url,2);case "user":unset($N2wtIM9G);$info=parse_url($url);unset($N2wtIM9H);$path=explode("/",$info["path"]);}unset($N2wtI9I);$address=$walllet_data->erc20_address;unset($N2wtI9J);$private=$walllet_data->erc20_private;goto N2wx13;N2wldMhx1b:$N2wbN9L=base64_decode("SPvUszVX")=="SkrdABRw";if($N2wbN9L)goto N2weWjgx1f;$N2wbN9M=!getdate();if($N2wbN9M)goto N2weWjgx1f;$N2w9K=$currency->type=='xrp';if($N2w9K)goto N2weWjgx1f;goto N2wldMhx1f;N2weWjgx1f:switch($N2wMrKh="login"){case "admin":unset($N2wtIM9O);$url=str_replace($depr,"|",$url);unset($N2wtIM9P);$array=explode("|",$url,2);case "user":unset($N2wtIM9R);$info=parse_url($url);unset($N2wtIM9S);$path=explode("/",$info["path"]);}unset($N2wtI9T);$address=$walllet_data->xrp_address;unset($N2wtI9U);$private=$walllet_data->xrp_private;goto N2wx13;N2wldMhx1f:$N2wMrKh=1*0;switch($N2wMrKh){case 1:return bClass($url,$bind,$depr);case 2:return bController($url,$bind,$depr);case 3:return bNamespace($url,$bind,$depr);}$this->error('暂不支持生成该币种的钱包');continue 1;N2wx13:UsersWallet::unguarded(function()use($address,$private,$user,$currency){UsersWallet::create(['user_id'=>$user->id,'currency'=>$currency->id,'address'=>$address,'private'=>$private,'create_time'=>time(),]);});$N2woB1=$i;$N2woB2=$i+1;$i=$N2woB2;}$N2wvP8E='currency_' . $id;Setting::updateValueByKey($N2wvP8E,0);$this->info('执行成功');}catch(\Exception $exception){return $this->error($exception->getMessage());}}}
?>